<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="使用说明">使用说明</h1>
<p>centos7-custom-iso-build 是一个能快速定制centos7 iso 的脚本</p>
<h1 id="准备工作">准备工作</h1>
<ul>
<li>工作系统 : centos7</li>
<li>运行依赖 : yum install lorax yum-uilts genisoimage createrepo -y</li>
</ul>
<h1 id="构建iso">构建ISO</h1>
<pre><code>bash build.sh &lt;Produce_Name&gt; &lt;Version&gt;
例如:
bash build.sh SHENLAN 17</code></pre>
<h1 id="使用dd工具制作启动u盘">使用dd工具制作启动U盘</h1>
<ul>
<li>针对BIOS主板的U盘启动制作方式：</li>
</ul>
<pre><code> isohybrid centos7-custom-xxx.iso
 dd if=centos7-custom-xxx.iso of=/dev/sdX</code></pre>
<ul>
<li>针对BIOS主板的U盘启动制作方式</li>
</ul>
<pre><code>isohybrid --uefi centos7-custom-xxx.iso
dd if=centos7-custom-xxx.iso of=/dev/sdX</code></pre>
<h1 id="使用syslinux工具制作启动u盘">使用syslinux工具制作启动U盘</h1>
<pre><code>mkfs.vfat /dev/sdb1
syslinux -i /dev/sdb1
dd if=/usr/share/syslinux/mbr.bin of=/dev/sdb bs=440 count=1
fatlabel /dev/sdb1 &quot;SHENLAN 17&quot;</code></pre>
<p>最后将ISO中全部文件，包括两个隐藏文件（.discinfo 和 .treeinfo ) 拷贝到U盘分区</p>
<h1 id="最小定制修改参考列表">最小定制修改参考列表</h1>
<pre><code>* centos-release        # 名称标志
* redhat-bookmarks      # firefox默认书签
* redhat-indexhtml      # firefox默认主页
* firefox               # 首次启动主页
* redhat-logos          # 默认主题背景资源
* adwaita-icon-theme    # 替换自定义 icon
* grub2                 # 定义 /boot/efi/EFI/目录： 修改 efidir变量
* shim                  # 定义 /boot/efi/EFI/目录： 修改 efidir变量
* shim-signed           # 定义 /boot/efi/EFI/目录： 修改 efidir变量
* anaconda              # 添加 pyanaconda/installclasses/custom.py 
                        # 主题微调可修改 /usr/share/anaconda/anaconda-gtk.css 
* gdm                   # 修改默认logo</code></pre>
<h1 id="参考">参考</h1>
<ul>
<li><a href="https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/7/html/desktop_migration_and_administration_guide/customizing-login-screen">gdm默认logo定制</a></li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html-single/anaconda_customization_guide/index">anaconda定制开发</a></li>
<li><a href="https://github.com/rhinstaller/lorax">lorax 源码</a></li>
<li><a href="https://github.com/rhinstaller/anaconda">anaconda 源码</a></li>
</ul>
</body>
</html>
